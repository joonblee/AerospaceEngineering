This code is orginated from JH's paper, Fig. 4.


