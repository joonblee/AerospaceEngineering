[?1h=
                                  < M A T L A B (R) >
                        Copyright 1984-2018 The MathWorks, Inc.
                         R2018b (9.5.0.944444) 64-bit (glnxa64)
                                    August 28, 2018

 
To get started, type doc.
For product information, visit www.mathworks.com.
 
[H[2J ### ----- Start code ----- ### 

__________________________________________
Initial equation is [ Ma + Cv + Ku = P ] 

Initial conditions...

M =

  208.6000         0         0         0         0
         0  208.6000         0         0         0
         0         0  208.6000         0         0
         0         0         0  208.6000         0
         0         0         0         0  104.3000


K =

   1.0e+05 *

    5.9596   -3.7663    1.5106   -0.3776    0.0630
   -3.7663    4.6366   -3.3896    1.3220   -0.2203
    1.5106   -3.3896    4.4499   -3.0111    0.8185
   -0.3766    1.3220   -3.0111    3.1263   -1.1539
    0.0630   -0.2203    0.8185   -1.1539    0.5092


C =

     0     0     0     0     0
     0     0     0     0     0
     0     0     0     0     0
     0     0     0     0     0
     0     0     0     0     0


P =

           0
           0
           0
           0
        1000

__________________________________________


__________________________________________
 ### ----- Modal Analysis ----- ### 


 [V,D]=eig(K,M)
V: right eigenvectors, D: diagonal matrix of eigenvalues (KV = DMV)
V =

    0.9054    1.0000    0.7847    0.3139    0.0638
   -1.0000   -0.2500    0.8025    0.7303    0.2295
    0.8945   -0.6725   -0.4886    0.6708    0.4602
   -0.5387    0.8521   -0.7027    0.0064    0.7245
    0.3010   -0.6284    1.0000   -1.0000    1.0000


D =

   1.0e+03 *

    5.6842         0         0         0         0
         0    2.6481         0         0         0
         0         0    0.7601         0         0
         0         0         0    0.1043         0
         0         0         0         0    0.0032


%% [W,k]=sort(diag(D))
_k_ is the same size as _diag(D)_ and describes the arrangement of the elements of _diag(D)_ into _W_ along the sorted dimension.
diag(D) =
ans =

   1.0e+03 *

    5.6842
    2.6481
    0.7601
    0.1043
    0.0032


W =

   1.0e+03 *

    0.0032
    0.1043
    0.7601
    2.6481
    5.6842


k =

     5
     4
     3
     2
     1


%% V=V(:,k) 
k_th column of matrix V.
V =

    0.0638    0.3139    0.7847    1.0000    0.9054
    0.2295    0.7303    0.8025   -0.2500   -1.0000
    0.4602    0.6708   -0.4886   -0.6725    0.8945
    0.7245    0.0064   -0.7027    0.8521   -0.5387
    1.0000   -1.0000    1.0000   -0.6284    0.3010

Phi =

    0.0039    0.0173    0.0344    0.0443    0.0365
    0.0140    0.0402    0.0352   -0.0111   -0.0403
    0.0280    0.0369   -0.0214   -0.0298    0.0360
    0.0441    0.0004   -0.0308    0.0378   -0.0217
    0.0609   -0.0550    0.0439   -0.0279    0.0121




%% Factor=diag(V'*M*V)
V'MV =
ans =

  269.8071    0.2132    0.0769    0.0241    0.0115
    0.2132  329.9882    0.0327   -0.0097    0.0030
    0.0769    0.0327  519.8834   -0.0690   -0.0041
    0.0241   -0.0097   -0.0690  508.6361    0.0410
    0.0115    0.0030   -0.0041    0.0410  616.5109


Factor =

  269.8071
  329.9882
  519.8834
  508.6361
  616.5109


%% Phi=V*inv(sqrt(diag(Factor)))
diag(Factor) =
ans =

  269.8071         0         0         0         0
         0  329.9882         0         0         0
         0         0  519.8834         0         0
         0         0         0  508.6361         0
         0         0         0         0  616.5109

sqrt(diag(Factor)) =
ans =

   16.4258         0         0         0         0
         0   18.1656         0         0         0
         0         0   22.8010         0         0
         0         0         0   22.5530         0
         0         0         0         0   24.8296

inv(sqrt(diag(Factor))) =
ans =

    0.0609         0         0         0         0
         0    0.0550         0         0         0
         0         0    0.0439         0         0
         0         0         0    0.0443         0
         0         0         0         0    0.0403


Phi =

    0.0039    0.0173    0.0344    0.0443    0.0365
    0.0140    0.0402    0.0352   -0.0111   -0.0403
    0.0280    0.0369   -0.0214   -0.0298    0.0360
    0.0441    0.0004   -0.0308    0.0378   -0.0217
    0.0609   -0.0550    0.0439   -0.0279    0.0121


%%
lambda =

     2

phi = Phi(:,1:lambda)
phi =

    0.0039    0.0173
    0.0140    0.0402
    0.0280    0.0369
    0.0441    0.0004
    0.0609   -0.0550


%%
M_ =

    1.0000    0.0007
    0.0007    1.0000


C_ =

     0     0
     0     0


K_ =

    3.1744    0.0745
    0.0023  104.2838


P_ =

   60.8798
  -55.0492

__________________________________________


### ----- Natural Frequencies, w ----- ### 

 Omega=diag(sqrt(Phi'*K*Phi))
Phi'KPhi =
ans =

   1.0e+03 *

    0.0032    0.0001    0.0002    0.0002    0.0002
    0.0000    0.1043    0.0001   -0.0001    0.0000
    0.0000    0.0000    0.7601   -0.0004   -0.0000
    0.0000   -0.0000   -0.0001    2.6481    0.0004
    0.0000    0.0000   -0.0000    0.0002    5.6842

sqrt(Phi'KPhi) =
ans =

  Columns 1 through 4

   1.7817 + 0.0000i   0.2730 + 0.0000i   0.3952 + 0.0000i   0.4147 + 0.0000i
   0.0476 + 0.0000i  10.2119 + 0.0000i   0.2448 + 0.0000i   0.0000 + 0.2510i
   0.0255 + 0.0000i   0.0907 + 0.0000i  27.5700 + 0.0000i   0.0000 + 0.5959i
   0.0144 + 0.0000i   0.0000 + 0.0498i   0.0000 + 0.3193i  51.4594 + 0.0000i
   0.0095 + 0.0000i   0.0262 + 0.0000i   0.0000 + 0.0743i   0.4402 + 0.0000i

  Column 5

   0.4010 + 0.0000i
   0.1937 + 0.0000i
   0.0000 + 0.2033i
   0.6449 + 0.0000i
  75.3937 + 0.0000i


Omega =

    1.7817
   10.2119
   27.5700
   51.4594
   75.3937


 w = diag(Omega(1:lambda))
w =

    1.7817         0
         0   10.2119

__________________________________________


[?1l>
